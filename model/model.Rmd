---
title: "Untitled"
author: "GrayDE"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

>>> Xây dựng các mô hình <<<

```{r cars}
summary(cars)
```

>>> Thư viện 

```{r pressure, echo=FALSE}
install.packages("e1071")
library(e1071)
library(randomForest)
library(dplyr)
library(knitr)
library(broom)
library(neuralnet)
library(caret)
library(dplyr)
```


>>> Mô hình 1

```{r}
# Bước 1: Tách train/test
set.seed(123)
splitIndex <- createDataPartition(selected_data$LIFE.EXPECTANCY, p = 0.8, list = FALSE)
train_data <- selected_data[splitIndex, ]
test_data <- selected_data[-splitIndex, ]

# Bước 2: Chuẩn hóa dữ liệu (normalize [0,1])
normalize <- function(x) {
  return((x - min(x)) / (max(x) - min(x)))
}

train_data_norm <- as.data.frame(lapply(train_data, normalize))
test_data_norm <- as.data.frame(lapply(test_data, normalize))

# Bước 3: Xây dựng công thức hồi quy
formula_lm <- LIFE.EXPECTANCY ~ INCOME.COMPOSITION.OF.RESOURCES + ADULT.MORTALITY + BMI + PERCENTAGE.EXPENDITURE + TOTAL.EXPENDITURE + SCHOOLING

# Bước 4: Huấn luyện mô hình hồi quy
model_lm <- lm(formula_lm, data = train_data_norm)

# Bước 5: In thông số mô hình
summary(model_lm)

```
>>>   Mô hình Random Forest Regression

```{r}
# Bước 1: Huấn luyện mô hình Random Forest
set.seed(123)
model_rf <- randomForest(
  formula_lm, 
  data = train_data_norm,
  ntree = 500,              # Số lượng cây
  importance = TRUE         # Cho phép tính tầm quan trọng biến
)

# Bước 2: In thông số mô hình
print(model_rf)
importance(model_rf)        # Xem mức độ quan trọng của các biến
```
>>> Support Vector Regression (SVR)

```{r}
# Cài thư viện nếu chưa có
library(e1071)

# Bước 1: Huấn luyện mô hình SVR
set.seed(123)
model_svr <- svm(
  formula_lm,
  data = train_data_norm,
  type = "eps-regression",    # Hồi quy epsilon
  kernel = "radial"           # Kernel RBF (phi tuyến)
)

# Bước 2: In thông số mô hình
print(model_svr)